# ========================================
# RUS-CONNECT ML Trading System
# Environment Configuration Template
# ========================================
# Copy this file to .env and fill in your values
# Command: cp env.example .env

# ========================================
# KAFKA CONFIGURATION
# ========================================
# Kafka broker addresses (comma-separated for multiple brokers)
KAFKA_BROKERS=kafka:9092
# For local development outside Docker:
# KAFKA_BROKERS=localhost:9092

# ========================================
# DATABASE
# ========================================
# Full connection string for runtime services (analytics-engine, data-fetcher)
CH_DSN=clickhouse://app:app_password@clickhouse:9000/default?dial_timeout=5s&max_execution_time=60

# For local development outside Docker:
# CH_DSN=clickhouse://app:app_password@localhost:9000/default?dial_timeout=5s&max_execution_time=60

# ========================================
# BYBIT API CREDENTIALS (Optional)
# ========================================
# NOTE: Currently data-fetcher uses PUBLIC endpoints and doesn't require API keys
# These are here for future authenticated endpoints (private trading, account data)
# Get your API keys from: https://www.bybit.com/app/user/api-management

# BYBIT_API_KEY=your_api_key_here
# BYBIT_API_SECRET=your_api_secret_here

# API key permissions (when you create them):
# ✅ Read-Only: Market Data
# ⚠️ DO NOT enable Trading permissions unless absolutely needed

# ========================================
# SERVICE PORTS
# ========================================
# Analytics Engine HTTP Server
ANALYTICS_ENGINE_PORT=8081

# API Gateway HTTP Server  
API_GATEWAY_PORT=8080

# Frontend Development Server
VITE_PORT=5173

# ========================================
# SERVICE URLS (for inter-service communication)
# ========================================
# URL for API Gateway to reach Analytics Engine
ANALYTICS_ENGINE_URL=http://analytics-engine:8081

# For local development:
# ANALYTICS_ENGINE_URL=http://localhost:8081

# ========================================
# ML MODEL CONFIGURATION
# ========================================
# Confidence threshold for emitting signals (0.0 - 1.0)
MODEL_CONFIDENCE_THRESHOLD=0.35

# Learning rate for neural network
MODEL_LEARNING_RATE=0.01

# Number of features extracted from candles
MODEL_FEATURE_COUNT=16

# Warm-up thresholds for real training path
ML_MIN_CANDLES_BOOTSTRAP=20
ML_MIN_CANDLES=60

# ML Prediction horizon - how far ahead to predict (in minutes)
# Lower = faster learning feedback, Higher = longer-term predictions
# Recommended: 5 for fast learning, 15 for standard
ML_PREDICTION_HORIZON_MIN=5

# ML training epochs
ML_TRAIN_EPOCHS=30

# ML retrain interval
ML_RETRAIN_INTERVAL=5m

# ML max training examples to keep per symbol
ML_MAX_TRAINING_EXAMPLES=4000

# ML neutral threshold (for SIDEWAYS classification)
ML_NEUTRAL_THRESHOLD=0.001

# ML autopilot (set to 0 to disable)
ML_AUTOPILOT_ENABLED=1

# ========================================
# MONITORING & LOGGING
# ========================================
# Log level: DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO

# Enable structured logging (JSON format)
STRUCTURED_LOGGING=false

# Prometheus metrics endpoint enabled
METRICS_ENABLED=true
METRICS_PORT=9090

# ========================================
# DEVELOPMENT & DEBUG
# ========================================
# Gin framework mode: debug, release, test
GIN_MODE=release

# Enable debug logs for Kafka
KAFKA_DEBUG=false

# Enable SQL query logging
SQL_DEBUG=false

# ========================================
# DOCKER COMPOSE OVERRIDES
# ========================================
# These are typically set by docker-compose.yml
# But can be overridden here for local testing

# COMPOSE_PROJECT_NAME=rus-connect
# DOCKER_NETWORK=rus-connect-network

# ========================================
# SECURITY
# ========================================
# JWT secret for API authentication (if implemented)
# JWT_SECRET=your-super-secret-jwt-key-change-this-in-production

# API rate limiting
# RATE_LIMIT_REQUESTS_PER_MINUTE=100

# CORS allowed origins (comma-separated)
# CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# ========================================
# FEATURE FLAGS
# ========================================
# Enable/disable specific features
ENABLE_AUTO_TRADING=false
ENABLE_BACKTESTING=true
ENABLE_MODEL_CALIBRATION=true
ENABLE_WEBSOCKET_STREAMING=true

# ========================================
# ADVANCED SETTINGS
# ========================================
# Kafka consumer group IDs
KAFKA_CONSUMER_GROUP_TICKER=api-gateway-ticker-group
KAFKA_CONSUMER_GROUP_SIGNALS=api-gateway-signals-group
KAFKA_CONSUMER_GROUP_DIRECTION=api-gateway-direction-group

# Kafka topics
KAFKA_TOPIC_TICKER=ticker
KAFKA_TOPIC_ORDERBOOK=orderbook
KAFKA_TOPIC_TRADES=trades
KAFKA_TOPIC_CANDLES=candle_1m
KAFKA_TOPIC_SIGNALS=signals
KAFKA_TOPIC_DIRECTION_SIGNALS=direction_signals

# Database connection pool settings
DB_MAX_OPEN_CONNECTIONS=25
DB_MAX_IDLE_CONNECTIONS=5
DB_CONNECTION_MAX_LIFETIME=300s

# HTTP client timeouts
HTTP_CLIENT_TIMEOUT=30s
HTTP_SERVER_READ_TIMEOUT=30s
HTTP_SERVER_WRITE_TIMEOUT=30s

# Graceful shutdown timeout
SHUTDOWN_TIMEOUT=5s

# ========================================
# LOGGING CONFIGURATION
# ========================================
# Log level: DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO
LOG_FORMAT=json

# ========================================
# CONNECTION POOL SETTINGS (per service)
# ========================================
# Data Fetcher (write-heavy, low concurrency)
DATA_FETCHER_DB_MAX_OPEN=10
DATA_FETCHER_DB_MAX_IDLE=3

# Analytics Engine (read/write balanced)
ANALYTICS_DB_MAX_OPEN=25
ANALYTICS_DB_MAX_IDLE=5

# ========================================
# RATE LIMITING
# ========================================
# API Gateway rate limiting
API_RATE_LIMIT=100
API_RATE_BURST=200

# ========================================
# MONITORING
# ========================================
# Prometheus metrics
ENABLE_PROMETHEUS_METRICS=true
PROMETHEUS_PORT=9090

# ========================================
# NOTES
# ========================================
# 1. Never commit .env file to git! It's already in .gitignore
# 2. For production, use strong passwords and secrets
# 3. Rotate API keys regularly
# 4. Use environment-specific files: .env.development, .env.production
# 5. Consider using secrets management tools (HashiCorp Vault, AWS Secrets Manager)
